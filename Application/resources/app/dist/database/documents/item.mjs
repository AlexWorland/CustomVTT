import BaseItem from"../../../common/documents/item.mjs";import ServerDocumentMixin from"../backend/server-document.mjs";import{setProperty}from"../../../common/utils/helpers.mjs";import{HTMLField}from"../../../common/data/fields.mjs";export default class Item extends(ServerDocumentMixin(BaseItem)){static async migrateSystem(){globalThis.logger.info("Migrating Item game system data to the latest Item data model.");const e=await this.find({});for(let t of e)try{t.updateSource({system:t.migrateSystemData()}),await this.db.updateOne({_id:t.id},t.toJSON())}catch(e){globalThis.logger.error(e)}globalThis.logger.info(`Successfully migrated ${e.length} Items to the latest system data model.`)}static get sanitizedFields(){const e=!!this._sanitizedFields,t=super.sanitizedFields;if(!e)for(let e of game.template.Item?.htmlFields||[]){setProperty(t,`system.${e}`,new HTMLField)}return t}}