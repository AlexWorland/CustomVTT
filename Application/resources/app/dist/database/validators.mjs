import{parseFragment,serialize}from"parse5";import sanitizeHTML from"sanitize-html";const TRUSTED_IFRAME_DOMAINS=["google.com","youtube.com"];export function cleanHTML(e){const a=parseFragment(e);return sanitizeHTML(serialize(a),{allowedTags:["header","main","section","article","aside","nav","footer","div","address","h1","h2","h3","h4","h5","h6","hr","br","p","blockquote","summary","details","span","code","pre","a","label","abbr","cite","mark","q","ruby","rp","rt","small","time","sub","sup","strong","em","b","i","u","s","del","ins","ol","ul","li","dl","dd","dt","table","thead","tbody","tfoot","tr","th","td","col","colgroup","form","input","select","option","button","datalist","fieldset","legend","meter","optgroup","progress","textarea","figure","figcaption","caption","img","video","map","area","track","picture","source","audio","object","iframe"],allowedAttributes:{"*":["class","data-*","id","title","style","draggable","aria-*","tabindex","dir"],a:["href","name","target","rel"],area:["alt","coords","href","rel","shape","target"],audio:["controls","loop","muted","src","autoplay"],blockquote:["cite"],button:["disabled","name","type","value"],col:["span"],details:["open"],fieldset:["disabled"],form:["name"],iframe:["src","srcdoc","name","height","width","loading","sandbox"],img:["height","src","width","usemap","sizes","srcset","alt"],input:["checked","disabled","name","value","placeholder","type","alt","height","list","max","min","placeholder","readonly","size","src","step","width"],label:["for"],li:["value"],map:["name"],meter:["value","min","max","low","high","optimum"],object:["type","data","height","width"],ol:["reversed","start"],optgroup:["disabled","label"],option:["disabled","selected","label","value"],progress:["max","value"],select:["name","disabled","multiple","size"],source:["media","sizes","src","srcset","type"],table:["border"],td:["colspan","headers","rowspan"],textarea:["rows","cols","disabled","name","readonly","wrap"],time:["datetime"],th:["abbr","colspan","headers","rowspan","scope","sorted"],track:["default","kind","label","src","srclang"],video:["controls","height","width","loop","muted","poster","src","autoplay"]},allowedSchemes:["http","https","data","mailto"],transformTags:{iframe:(e,a)=>{const t=URL.parseSafe(a.src)?.hostname;return TRUSTED_IFRAME_DOMAINS.some((e=>t===e||t?.endsWith(`.${e}`)))?delete a.sandbox:a.sandbox="allow-scripts allow-forms",{tagName:"iframe",attribs:a}}}})}export function stripTags(e){return e.replace(/<[^>]+>/g,"")}