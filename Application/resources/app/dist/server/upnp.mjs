import natupnp from"nat-upnp";export default class UPnP{constructor({port:t=3e4,ttl:i}={}){this.client=natupnp.createClient(),this.port=t,this.ttl=i||600,this._refreshId=null}createMapping(){return global.logger.info(`Requesting UPnP port forwarding to destination port ${this.port}`),this._map(),this._refreshId=setInterval(this._map.bind(this),1e3*this.ttl/2),this}_map(){config.options?.debug&&global.logger.debug(`Renewing UPnP port forwarding lease to destination port ${this.port}`),this.client.portMapping({public:this.port,private:this.port,ttl:this.ttl,description:"Foundry Virtual Tabletop"})}removeMapping(){this._refreshId&&clearInterval(this._refreshId),this.client.portUnmapping({public:this.port})}}